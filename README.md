# Bulk RNA-seq Pipeline (nf-core/rnaseq)

This repository documents a working configuration of the `nf-core/rnaseq` pipeline (v3.12.0) using Docker containers and custom genome references.

## âœ… Requirements
- Docker
- Nextflow >= 21.04.0
- Google Cloud SDK (`gsutil`)
- ~500 GB free space on main disk or a mounted external volume

## âœ… Genome
Genome: GRCh38 (GENCODE v46)

Folder: `~/bulk_rnaseq_clean_run/genome/gencode_v46/`

## âœ… Pipeline Command

```bash
nextflow run nf-core/rnaseq -r 3.12.0 -profile docker \
  --input input/stem_sample_sheet.csv \
  --outdir results \
  --fasta ~/bulk_rnaseq_clean_run/genome/gencode_v46/GRCh38.primary_assembly.genome.fa \
  --gtf ~/bulk_rnaseq_clean_run/genome/gencode_v46/gencode.v46.annotation.gtf \
  --star_index ~/bulk_rnaseq_clean_run/genome/gencode_v46/STARIndex \
  -c config/docker_user.config \
  -with-report -with-timeline -with-trace# bulkRNAseq


ðŸ”¬ Differential Expression Analysis with DESeq2

We use [DESeq2](https://bioconductor.org/packages/release/bioc/html/DESeq2.html) for differential gene expression analysis based on the output from `nf-core/rnaseq`.

Inputs
- `salmon.merged.gene_counts.tsv`: generated by nf-core/rnaseq using STAR + Salmon
- `metadata_stem_1.csv`: sample sheet with `sample_id`, `condition`, `group_id`

Output
For each stem cell line (`group_id`), each edited condition (e.g., `H1_AAVS1`) is compared against the corresponding WT control (`H1_WT`, etc.). Results include:
- `*_ALL.csv`: all DE results
- `*_FILTERED.csv`: FDR < 0.05 and abs(log2FC) > 1
- `*_volcano.pdf`: annotated volcano plots with top gene names

Run the Script

```bash
Rscript deseq2/deseq2_gene_names.R \
  results/star_salmon/salmon.merged.gene_counts.tsv \
  input/metadata_stem_1.csv \
  results/deseq2_outputs
